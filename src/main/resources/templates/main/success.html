<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../../static/css/success.css" th:href="@{/css/success.css}">
    <title>Success!</title>
</head>
<body>
<p>Success</p>

<div id="toggle">
    <label class="switch">
        <input type="checkbox" id="toggle-switch" onclick="toggler()">
        <span class="slider round"></span>
    </label>

    <div th:if="${agent.role} == 'manager'">
        <p>Managers only 1</p>
    </div>

    <div th:switch="${agent.role}" id="manager-only">
        <p th:case="'manager'">Managers only 2</p>
    </div>


    <div name="calls_display">
        <table>
            <thead>
            <tr>
                <th>Call ID</th>
                <th>Call description</th>
                <th>Call Agent name</th>
                <th>Caller name</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="call : ${calls}">
                <td th:text="${call.id}"></td>
                <td th:text="${call.description}"></td>
                <td th:text="${call.agent}"></td>
                <td th:text="${call.caller}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
<script>

    //let managersOnly = document.getElementById("manager-only");
    let contactNumber = sessionStorage.getItem("contactNumber");
    if (contactNumber === null) {

    }
    function toggler() {
        let contactNumber = sessionStorage.getItem("contactNumber")
        console.log(contactNumber);
        let id = sessionStorage.getItem("agent_id");
        let checkboxVal = document.getElementById("toggle-switch");
        if (checkboxVal.checked === true) {
            let xhttp = new XMLHttpRequest(); //creating ajax req
            //console.log(document.getElementById("id"));
            xhttp.open("GET","http://localhost:8082/" + id + "/mark/online",true);
            xhttp.send();
        } else {
            let xhttp = new XMLHttpRequest();
            xhttp.open("GET","http://localhost:8082/" + id + "/mark/offline",true);
            xhttp.send();
        }
    }

</script>